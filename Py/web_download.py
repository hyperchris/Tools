import smtplibfrom email.mime.text import MIMETextimport StringIOfrom htmlentitydefs import name2codepointfrom selenium import webdriverfrom time import timeimport timefrom datetime import datefrom dateutil.rrule import rrule, DAILYimport csvcsv_headers = ['CERTIFICATE_NO', 'REGION', 'DOMESTIC', 'FOREIGN', 'PROVINCE', 'ABOUT', 'DATE']def main(start_page = 1, end_page = 1):	driver = webdriver.Firefox()	driver.get("http://wszw.hzs.mofcom.gov.cn/fecp/fem/corp/fem_cert_stat_view_list.jsp")		f = open('result.csv', 'w') # load csv writer and header	f_csv = csv.DictWriter(f, csv_headers)	f_csv.writeheader()	last_table = [] # register table records all existing companies	for i in range(start_page, end_page + 1):		print "processing page " + `i`		script_cmd = "javascript:document.bottomGrid1pageTool.Grid1toPageNo.value=" + `i` + ";document.bottomGrid1pageTool.submit()"		driver.execute_script(script_cmd) # load the webpage				content = driver.page_source.encode("utf-8") # get the content		buf = StringIO.StringIO(content)		rows = []		reg_table = last_table		last_table = []		line = 'dummy'		while line != '':			line = buf.readline()			if "<tr height=\"20\" class=\"listTableBody\">" in line:				print 'Find one company'				elements = {}				counter = 0				round_num = 0				while True: # read in all 7 kinds of information:					line = buf.readline()					round_num += 1					if len(line) > 10: # valid line						elements[csv_headers[counter]] = line.split('><div>')[-1].split('</div>')[0]						print 'counter is: ' + `counter`+ ' round_num ' + `round_num`						counter += 1					if counter > 7 or round_num > 50: # error						print 'ERROR: counter ' + `counter` + ' round_num ' + `round_num`						return					if csv_headers[-1] in elements: # finish loading every tag						break				key = elements[csv_headers[0]] + elements[csv_headers[1]] + elements[csv_headers[2]] + elements[csv_headers[3]] + elements[csv_headers[4]]				last_table.append(key)				if key in reg_table: # if the "about" already exists in the last page, continue					continue				else: # record the company					rows.append(elements)					reg_table.append(key) # in case that there are duplicate items in the same table 		f_csv.writerows(rows)		print 'finish processing page ' + `i`'''		'''	if __name__ == "__main__":	start_page = 816	end_page = 1936  # 1936 max	main(start_page, end_page)	print 'done'